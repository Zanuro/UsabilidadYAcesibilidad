<!DOCTYPE html>
<html lang="es">
   <head>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
      <title>Club de la Lectura</title>
      <meta http-equiv="content-type"/>
      <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=yes"/>
      <meta charset="UTF-8"/>
      <link rel="shortcut icon" type="image/x-icon" href="img/icon.ico"/>
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
      <link rel="stylesheet" type="text/css" href="style/style.css"/>
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131489316-3"></script>
      <script>
         window.dataLayer = window.dataLayer || [];
         function gtag(){dataLayer.push(arguments);}
         gtag('js', new Date());

         gtag('config', 'UA-131489316-3');
      </script>
      <script src="https://www.gstatic.com/firebasejs/5.10.0/firebase.js"></script>
      <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/5.10.0/firebase-auth.js"></script>
      <script src="https://www.gstatic.com/firebasejs/5.10.0/firebase-database.js"></script>
      <script>
        // Initialize Firebase
        var config = {
           apiKey: "AIzaSyCGk645y7ZSl-e1sUHio8DRiN4ytvkMXnU",
           authDomain: "webua1819.firebaseapp.com",
           databaseURL: "https://webua1819.firebaseio.com",
           projectId: "webua1819",
           storageBucket: "webua1819.appspot.com",
           messagingSenderId: "28657746169"
        };
        firebase.initializeApp(config);
    </script>

      <script
        src="https://code.jquery.com/jquery-3.3.1.js"
        integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
        crossorigin="anonymous">
      </script>

      <script>
          $(function(){
          $("#footer").load("footer.html");
        });
      </script>


      <script>
        function toggleFocus(el)
        {
          el.style.backgroundColor =  el.style.backgroundColor=="yellow" ? "inherit" : "yellow";
        }
      </script>

      </head>
    <body>
      <nav role="custom-dropdown" aria-label="Top Menu Bar">
         <div class="nav-wrapper">
            <a href="index.html" class="brand-logo" onfocus="toggleFocus(this)" onblur="toggleFocus(this)"><img id="logo-pag" src="img/logo-b.png" alt="logo club de lectura"></img></a>
            <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">menu</i></a>
            <ul class="right hide-on-med-and-down" id="barra" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">
               <li><a href="catalogo.html" role="menuitem" tabindex="0" aria-expanded="false" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">Catálogo</a></li>
               <li><a href="recomendacion.html" role="menuitem" tabindex="0" aria-expanded="false" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">Recomendacion de libros</a></li>
               <li><a href="añadirlibros.html" role="menuitem" tabindex="0" aria-expanded="false" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">Añadir Libros</a></li>
               <li><a href="login.html" role="menuitem" tabindex="0" aria-expanded="false" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">Sign Up</a></li>
               <li><a href="signup.html" role="menuitem" tabindex="0" aria-expanded="false" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">Log In</a></li>
               <li><a href="#!" id="logout" role="menuitem" tabindex="0" aria-expanded="false" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">Log Out</a></li>
               <li>
                  <div class="center row">
                     <div class="col s12 ">
                        <div class="row" id="topbarsearch">
                           <div class="input-field col s6 s12 red-text">
                              <i class="white-text material-icons prefix"></i>
                              <input type="text" aria-label="barra de navegacion" placeholder="search" id="autocomplete-input" class="autocomplete white-text" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">
                           </div>
                        </div>
                     </div>
                  </div>
               </li>
               </ul>
         </div>
      </nav>

      <ul class="sidenav" id="mobile-demo" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">
               <li><a href="catalogo.html" role="menuitem" tabindex="0" aria-expanded="false" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">Catálogo</a></li>
               <li><a href="recomendacion.html" role="menuitem" tabindex="0" aria-expanded="false" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">Recomendacion de libros</a></li>
               <li><a href="añadirlibros.html" role="menuitem" tabindex="0" aria-expanded="false" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">Añadir Libros</a></li>
               <li><a href="login.html" role="menuitem" tabindex="0" aria-expanded="false" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">Sign Up</a></li>
               <li><a href="signup.html" role="menuitem" tabindex="0" aria-expanded="false" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">Log In</a></li>
               <li><a href="#!" id="logout" role="menuitem" tabindex="0" aria-expanded="false" onfocus="toggleFocus(this)" onblur="toggleFocus(this)">Log Out</a></li>
               </ul>
      <div id="background" class="center row" role="header">
         <div class="col s12 m12 l12 xl12">
            <h1 class="titulo" aria-label="titulo">El club de Lectura</h1>
         </div>
      </div>

      <div id="anadir-libros" class="center row" role="main">
            <div class="center row" style="min-height:600px;">
            <h2 class="titulo-anadir-libro" aria-label="titulo">Añade tu libro favorito!</favorito!></h2>
            <div class="col s8 offset-s2 m8 offset-m2 l7 offset-l2 xl4 offset-xl4">
                <form class="formulario" aria-label="Formulario añadir libros" method="post" onsubmit="return false">
                    <p class ="anadir-form">* Titulo: <input onfocus="toggleFocus(this)" onblur="toggleFocus(this)" type="text" aria-label="El señor de los Anillos" placeholder="El señor de los Anillos" aria-placeholder="El señor de los Anillos" id="libro" aria-required="true" aria-describedby="alerta-title" aria-live="assertive" aria-label="Titulo libro"/></p>
                    <span id="alerta-title" role="tooltip" aria-live="assertive"> </span>
                    <p class ="anadir-form">* Autor: <input onfocus="toggleFocus(this)" onblur="toggleFocus(this)" type="text" aria-label="J.R.Tolkien" placeholder="J.R.Tolkien" aria-placeholder="J.R.Tolkien" id="nombre" aria-required="true" aria-describedby="alerta-autor" aria-live="assertive" aria-label="Autor libro"/></p>
                    <span id="alerta-autor" role="tooltip" aria-live="assertive"> </span>
                    <p class ="anadir-form">Año: <input onfocus="toggleFocus(this)" onblur="toggleFocus(this)" type="number" aria-label="1992" placeholder="1992" aria-placeholder="1992" id="agnos" aria-describedby="alerta-agno" aria-live="assertive" aria-label="Año libro"></p>
                    <span id="alerta-agno" role="tooltip" aria-live="assertive"> </span>
                    <p class ="anadir-form">* Genero: <input onfocus="toggleFocus(this)" onblur="toggleFocus(this)" type="text" title="Comedia,Aventura,Policiaca,Historia,Ficcion,Clasicos" pattern=".{7,10}" aria-label="Comedia,Aventura,Policiaca,Historia,Ficcion,Clasicos" placeholder = "Comedia/Aventura/Policiaca/Historia/Ficcion/Clasicos" aria-placeholder = "Comedia/Aventura/Policiaca/Historia/Ficcion/Clasicos"id="genero" aria-required="true" aria-describedby="alerta-genero" aria-live="assertive" aria-label="Genero libro"/></p>
                    <span id="alerta-genero" role="tooltip" aria-live="assertive"> </span>
                    <p class ="anadir-form">ISBN: <input onfocus="toggleFocus(this)" onblur="toggleFocus(this)" type="number" id="isbn" aria-label="1578347859023" placeholder="1578347859023" aria-placeholder="1578347859023" minlength="13" maxlength="13" aria-describedby="alerta-isbn" aria-live="assertive" aria-label="ISBN libro"></p>
                    <span id="alerta-isbn" role="tooltip"aria-live="assertive"> </span>
                    <form action="#" method="post" enctype="multipart/form-data">
                     <div class="file-field input-field">
                        <div class="btn waves-effect waves-teal">
                        <span>Imagen</span>
                        <input type="file">
                        </div>
                        <div class="file-path-wrapper">
                        <input id="imagen-libro" class="file-path validate" type="file" aria-label="Añadir imagen del libro" onchange="loadImageFile();" placeholder="Añadir imagen del libro" style="max-heigth:300px;">
                        <img id="img-libro" src="" alt="">
                        </div>
                     </div>
                     </form>
                     <span id="alerta-imagen" role="tooltip"aria-live="assertive"> </span>
                    <span id="libro-added"> </span>
                    <div id = "botones-libros">
                        <button onfocus="toggleFocus(this)" onblur="toggleFocus(this)" aria-pressed="false" tabindex="0" class="btn waves-effect waves-teal" type="submit" id="submit" value="Enviar" alt="Boton Submit">Submit
                        <i class="material-icons right">send</i>
                        </button>
                        <button onfocus="toggleFocus(this)" onblur="toggleFocus(this)" aria-pressed="false" tabindex="0" class="btn waves-effect waves-teal" type="reset" id="reset" value="Borrar" alt="Boton Reset">Reset
                        <i class="material-icons right">delete</i>
                        </button>
                    </div>
                    <br>
                    <p id="texto-oblig">Los campos con * son obligatorios</p>
                </form>
            </div>
         </div>
         </div>
      <footer class="page-footer" role="contentinfo" aria-label="Footer" style="position:absoulte;bottom:0;width:100%">
        <div class="container">
           <div class="center row">
              <div class="col l4 s12">
                 <h5 class="white-text">Quienes somos</h5>
                 <p class="grey-text text-lighten-4">
                    Somos una biblioteca digital donde podrás encontar una amplia variedad de libros, comentarlos con el resto de usuarios, apuntar eventos...
                 </p>
              </div>
              <div class="col l4 offset-l1 s12">
                 <h5 class="white-text">Ubicación</h5>
                 <iframe src="https://www.google.com/maps/embed?pb=!1m16!1m12!1m3!1d3506.8985774735934!2d-16.322677222337415!3d28.48260090236116!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m1!1m0!5e0!3m2!1ses!2ses!4v1553097652506" frameborder="0" style="border:0" allowfullscreen></iframe>
                 <p class="lugar"><i class="fas fa-map-marker-alt"></i>Camino San Francisco de Paula</p>
              </div>
              <div class="col l2 offset-l1 s12">
                 <h5 class="white-text">Contactanos</h5>
                 <ul>
                    <li><a class="grey-text text-lighten-3" href="#!">
                       <i class="fab fa-twitter"></i>
                       Twitter</a>
                    </li>
                    <li><a class="grey-text text-lighten-3" href="#!">
                       <i class="fab fa-instagram"></i>
                       Instagram</a>
                    </li>
                    <li><a class="grey-text text-lighten-3" href="#!">
                       <i class="fab fa-facebook"></i>Facebook</a>
                    </li>
                 </ul>
              </div>
           </div>
        </div>
        <div class="footer-copyright">
           <div class="container">
              © 2019 Copyright Text
           </div>
        </div>
        <script type='text/javascript' src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script type='text/javascript' src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
        <script type='text/javascript' src="javascript/firebase.js"></script>
        <script type='text/javascript' src="javascript/func.js"></script>
        <script src="//static.filestackapi.com/filestack-js/1.x.x/filestack.min.js"></script>
         <script>
          window.onload = function() {
             add_libros_to_list();
          };



          function add_libros_to_list(){

                var  ul, li, a, i,txtValue;
                var lista = [];
                ul = document.getElementById("lista-libros");
                li = ul.getElementsByTagName('li');

                for (i = 0; i < li.length; i++) {
                a = li[i].getElementsByTagName("span")[0];
                txtValue = a.textContent || a.innerText;
                txtValue = txtValue.replace("more_vert"," ");
                lista.push(txtValue);
                }

                var librosRef = myDatabase.ref('libros');
                var refDB = myDatabase.ref().child('libros');
                refDB.on('value', function(snapshot) {
                
                snapshot.forEach(function(childSnapshot) {
                var childData = childSnapshot.key;
                ul = document.getElementById("lista-libros");
                li = ul.getElementsByTagName('li');
                var elems = li.length;

                if (lista.includes(childData) == false){
                    
                    get_put_authors("");
                    get_put_authors(childSnapshot.node_.children_.root_.left.value.value_);
                    
                    if(childSnapshot.val().imagen == null ){
                        var src = "https://bit.ly/2I05h6Q";
                    }
                    else{
                        var src = childSnapshot.val().imagen;
                    }
                        
                    if(elems % 3 == 0){
                        //anadir primero

                    var root = document.getElementById("lista-libros");

                    var li = document.createElement("li");
                    root.appendChild(li);
                    
                    var div1 = document.createElement('div');
                    div1.className = "col s8 offset-s2 m3 offset-m2 l3 offset-l2 xl2 offset-xl2";
                    
                    var elem1 = li.appendChild(div1);

                    var div2 = document.createElement('div');
                    div2.className = "card";

                    var elem2 = elem1.appendChild(div2);
                    
                    var div3 = document.createElement('div');
                    div3.className = "card-image waves-effect waves-block waves-light";
                    
                    var elem3 = elem2.appendChild(div3);

                    var img1 = document.createElement('img');
                    img1.className = "activator responsive-img";
                    console.log(childSnapshot.val().imagen);
                    img1.src = src;

                    var elem4 = elem3.appendChild(img1);

                    var div4 = document.createElement('div');
                    div4.className = "card-content";

                    var elem5 = elem2.appendChild(div4);

                    var span1 = document.createElement('span');
                    span1.className = "card-title activator grey-text text-darken-4";
                    span1.style.fontSize = "130%";

                    span1.textContent=`${childData}`;
                    
                    var elem6 = elem5.appendChild(span1);

                    var i1 = document.createElement('i');
                    i1.className = "material-icons right";

                    i1.textContent="more_vert";
                    
                    var elem7 = elem6.appendChild(i1);
                    

                    var div5 = document.createElement('div');
                    div5.className = "card-reveal";

                    var elem8 = elem2.appendChild(div5);

                    var span2 = document.createElement('span');
                    span2.className = "card-title grey-text text-darken-4";
                    span2.style.fontSize = "130%";
                    span2.style.textAlign = "left";

                    span2.textContent=`${childData}`;
                    
                    var elem9 = elem8.appendChild(span2);

                    var i2 = document.createElement('i');
                    i2.className = "material-icons right";

                    i2.textContent="close";
                    
                    var elem9 = elem9.appendChild(i2);

                    var br = document.createElement('br');

                    var elem9 = elem8.appendChild(br);

                    var p1 = document.createElement('p');

                    p1.innerHTML = "No hay informacion disponible.";

                    var elem10 = elem8.appendChild(p1);
                    
                    var p2 = document.createElement('p');

                    var elem11 = elem8.appendChild(p2);

                    var a1 = document.createElement('a');

                    a1.href = "https://www.amazon.com";
                    a1.style.fontSize = "130%";
                    a1.textContent=`${childData}`;

                    var elem12 = elem11.appendChild(a1);

                    }

                    else if(elems % 3 == 1){
                        //anadir centro

                    var root = document.getElementById("lista-libros");

                    var li = document.createElement("li");
                    root.appendChild(li);
                    
                    var div1 = document.createElement('div');
                    div1.className = "col s8 offset-s2 m3 offset-m2 l3 offset-l2 xl2 offset-xl1";
                    
                    var elem1 = li.appendChild(div1);

                    var div2 = document.createElement('div');
                    div2.className = "card";

                    var elem2 = elem1.appendChild(div2);
                    
                    var div3 = document.createElement('div');
                    div3.className = "card-image waves-effect waves-block waves-light";
                    
                    var elem3 = elem2.appendChild(div3);

                    var img1 = document.createElement('img');
                    img1.className = "activator responsive-img";
                    img1.src = src;

                    var elem4 = elem3.appendChild(img1);

                    var div4 = document.createElement('div');
                    div4.className = "card-content";

                    var elem5 = elem2.appendChild(div4);

                    var span1 = document.createElement('span');
                    span1.className = "card-title activator grey-text text-darken-4";
                    span1.style.fontSize = "130%";

                    span1.textContent=`${childData}`;
                    
                    var elem6 = elem5.appendChild(span1);

                    var i1 = document.createElement('i');
                    i1.className = "material-icons right";

                    i1.textContent="more_vert";
                    
                    var elem7 = elem6.appendChild(i1);
                    

                    var div5 = document.createElement('div');
                    div5.className = "card-reveal";

                    var elem8 = elem2.appendChild(div5);

                    var span2 = document.createElement('span');
                    span2.className = "card-title grey-text text-darken-4";
                    span2.style.fontSize = "130%";
                    span2.style.textAlign = "left";

                    span2.textContent=`${childData}`;
                    
                    var elem9 = elem8.appendChild(span2);

                    var i2 = document.createElement('i');
                    i2.className = "material-icons right";

                    i2.textContent="close";
                    
                    var elem9 = elem9.appendChild(i2);

                    var br = document.createElement('br');

                    var elem9 = elem8.appendChild(br);

                    var p1 = document.createElement('p');

                    p1.innerHTML = "No hay informacion disponible.";

                    var elem10 = elem8.appendChild(p1);
                    
                    var p2 = document.createElement('p');

                    var elem11 = elem8.appendChild(p2);

                    var a1 = document.createElement('a');

                    a1.href = "https://www.amazon.com";
                    a1.style.fontSize = "130%";
                    a1.textContent=`${childData}`;

                    var elem12 = elem11.appendChild(a1);

                    }

                    else if(elems % 3 == 2){
                        //anadir ultimo

                    var root = document.getElementById("lista-libros");

                    var li = document.createElement("li");
                    root.appendChild(li);
                    
                    var div1 = document.createElement('div');
                    div1.className = "col s8 offset-s2 m3 offset-m2 l3 offset-l2 xl2 offset-xl1";
                    
                    var elem1 = li.appendChild(div1);

                    var div2 = document.createElement('div');
                    div2.className = "card";

                    var elem2 = elem1.appendChild(div2);
                    
                    var div3 = document.createElement('div');
                    div3.className = "card-image waves-effect waves-block waves-light";
                    
                    var elem3 = elem2.appendChild(div3);

                    var img1 = document.createElement('img');
                    img1.className = "activator responsive-img";
                    img1.src = src;

                    var elem4 = elem3.appendChild(img1);

                    var div4 = document.createElement('div');
                    div4.className = "card-content";

                    var elem5 = elem2.appendChild(div4);

                    var span1 = document.createElement('span');
                    span1.className = "card-title activator grey-text text-darken-4";
                    span1.style.fontSize = "130%";

                    span1.textContent=`${childData}`;
                    
                    var elem6 = elem5.appendChild(span1);

                    var i1 = document.createElement('i');
                    i1.className = "material-icons right";

                    i1.textContent="more_vert";
                    
                    var elem7 = elem6.appendChild(i1);
                    

                    var div5 = document.createElement('div');
                    div5.className = "card-reveal";

                    var elem8 = elem2.appendChild(div5);

                    var span2 = document.createElement('span');
                    span2.className = "card-title grey-text text-darken-4";
                    span2.style.fontSize = "130%";
                    span2.style.textAlign = "left";

                    span2.textContent=`${childData}`;
                    
                    var elem9 = elem8.appendChild(span2);

                    var i2 = document.createElement('i');
                    i2.className = "material-icons right";

                    i2.textContent="close";
                    
                    var elem9 = elem9.appendChild(i2);

                    var br = document.createElement('br');

                    var elem9 = elem8.appendChild(br);

                    var p1 = document.createElement('p');

                    p1.innerHTML = "No hay informacion disponible.";

                    var elem10 = elem8.appendChild(p1);
                    
                    var p2 = document.createElement('p');

                    var elem11 = elem8.appendChild(p2);

                    var a1 = document.createElement('a');

                    a1.href = "https://www.amazon.com";
                    a1.style.fontSize = "130%";
                    a1.textContent=`${childData}`;

                    var elem12 = elem11.appendChild(a1);
                    }                    

                }
                });


            });

        }

      </script>
     </footer>
    </body>
</html>
